<!DOCTYPE html>
<html>
<head>
    <title>URL Shortener</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }
        h1 {
            text-align: center;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        form {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        input[type="text"] {
            flex: 1;
            padding: 10px;
            font-size: 16px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
        #shortenedUrls {
            margin-top: 20px;
        }
        #shortenedUrls p {
            word-break: break-all;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>URL Shortener</h1>
        <form id="shortenForm">
            <input type="text" id="longUrl" placeholder="Enter your long URL here" />
            <button type="submit" style="color: rgb(12, 12, 12);">Shorten</button>
        </form>
        <div id="shortenedUrls">
            <!-- Display recent shortened URLs here -->
        </div>
    </div>

    <script>
        const API_KEY = '8f345d03578547f1fe731714f7eab502';
        const API_URL = 'https://api.shrtco.de/v2/shorten';
        const MAX_RECENT_URLS = 5; // Adjust the number of recent URLs to display

        const shortenForm = document.getElementById('shortenForm');
        const longUrlInput = document.getElementById('longUrl');
        const shortenedUrlsContainer = document.getElementById('shortenedUrls');

        // Load recent shortened URLs from browser storage on page load
        window.addEventListener('load', () => {
            loadRecentUrls();
        });

        // Function to make API request and handle the response
        function shortenUrl(longUrl) {
            fetch(`${API_URL}?url=${encodeURIComponent(longUrl)}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
            })
            .then(response => response.json())
            .then(data => {
                if (data.ok) {
                    const shortUrl = data.result.short_link;
                    // Display the shortened URL and save it to browser storage
                    displayShortenedUrl(shortUrl);
                    saveToBrowserStorage(shortUrl);
                } else {
                    // Handle API error
                    alert('Error: Unable to shorten the URL.');
                }
            })
            .catch(error => {
                // Handle fetch error
                alert('Error: Unable to connect to the API.');
            });
        }

        // Function to display the shortened URL on the page
        function displayShortenedUrl(shortUrl) {
            const shortenedUrlElement = document.createElement('p');
            shortenedUrlElement.textContent = shortUrl;
            shortenedUrlsContainer.appendChild(shortenedUrlElement);
        }

        // Function to save the shortened URL to browser storage
        function saveToBrowserStorage(shortUrl) {
            let recentUrls = getRecentUrls();
            recentUrls.unshift(shortUrl);
            if (recentUrls.length > MAX_RECENT_URLS) {
                recentUrls = recentUrls.slice(0, MAX_RECENT_URLS);
            }
            localStorage.setItem('recentUrls', JSON.stringify(recentUrls));
        }

        // Function to retrieve the user's recent shortened URLs from browser storage
        function getRecentUrls() {
            const recentUrlsJSON = localStorage.getItem('recentUrls');
            return recentUrlsJSON ? JSON.parse(recentUrlsJSON) : [];
        }

        // Function to load and display the user's recent shortened URLs on the page
        function loadRecentUrls() {
            const recentUrls = getRecentUrls();
            recentUrlsContainer.innerHTML = '';
            recentUrls.forEach(url => {
                displayShortenedUrl(url);
            });
        }

        // Event listener for form submission
        shortenForm.addEventListener('submit', function (event) {
            event.preventDefault();
            const longUrl = longUrlInput.value.trim();
            if (longUrl) {
                shortenUrl(longUrl);
                longUrlInput.value = '';
            }
        });
    </script>
</body>
</html>
